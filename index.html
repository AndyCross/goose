<!DOCTYPE html>
    <head>
        <!-- Spotify CSS files -->
        <style>
            @import url('$views/css/buttons.css');
            @import url('$views/css/image.css');
            @import url('$views/css/list.css');
        </style>

        <!-- Project CSS files -->
        <link rel="stylesheet" type="text/css" href="css/main.css?rel=1">
        <link rel="stylesheet" type="text/css" href="css/github.css">
        <link rel="stylesheet" type="text/css" href="css/goose.css?rel=8">

        <script src="/js/jquery.min.js"></script>
        <script src="/js/jquery.signalR.min.js"></script>
        <script src="/js/jquery.jqote2.min.js"></script>
        <script type="text/javascript" src="/js/goosesong.js?rel=4"></script>
        <script src="http://gooser.azurewebsites.net/gosling/hubs" type="text/javascript"></script>
        
        <script src="/js/jTmpl.js"></script>
        <script src="/js/jargs.js?rel=1.9"></script>
        <script src="/js/flap.js?rel=1.1.25"></script>

    </head>
    <body>
        <div id="wrapper">
            <div id="index" class="section">
                <img src="/img/goose300x300.png" class="right" />
                <h2>Goose</h2>
                <h3>V0.1.13</h3>

                <p>Geo-synchronise playing.</p>
                
                <h2>About Goose</h2>
                <p>Goose is about sharing tracks with your friends (special ones we hope) in real time. Get them to plug in a share code, then play your music. They'll hear what you're hearing, when you're hearing it. </p>
                <p>Developed by a Goose and her pet Lion.</p>

                <div id="groupMembership" class="paddedBox">
                <p>For now, set the value of the below to determine the group you are leading or following. There are no limitations on what you can achieve in this group - i.e. you are not limited to only leading or following. We will build this functionality in before the beta release.</p>
                    <input type="text" id="groupIdentifier" value="123"></input>
                    <button onclick="javascript:doSetFlock()">Select flock</button>
                </div>


                <div id="data"></div>
                <div id="sendingInfo" style="display:none;">
                    <h3>You are sending</h3>
                    <p>This means you are in the state of syncing your tracks to your flock, having honk honked. If you have subsequently
                        received from another Lead Goose, you won't sync with them. Note that this should not be possible in the beta release
                        we will be careful with these states. Currently with only one group we can easily ninja each other and break this statefulness.</p>
                </div>
            </div>

            <div id="leadgoose" class="section" style="display:none;">
                    <h3>Lead Goose</h3>
                    <p>Choose the music that you want to share with your flock. Drag a playlist to the space below, or use the search function and HONK to select your track. </p>
                    <p>Simply press HONKHONK to play this music to every listener in your flock. </p>
                    <div class="share">
                        <input type="search" id="searchTerm" />
                    </div>
                    <div id="lead-drop">Drop some music here
                        <div id="lead-drop-data"></div>
                    </div>

                    <div id="prepareToShare"></div>
                    <div id="goosesongControl">
                        <ol id="playlistGooseSong"></ol>
                        <button onclick="federateMany()">Sing</button>
                        <div id="goosesongMessage"></div>
                    </div>
                    <script type="text/html" id="prepareToShare_tmpl">
                      <div id="<%=this.uri%>">
                        <div>
                          <a href="<%=this.album.uri%>"><img class="artistimage" src="<%=this.image%>"/></a>
                        </div>
                        <div class="subtleLinks">
                            <h2><a href="<%=this.artists[0].uri%>"><%=this.artists[0].name%></a></h2>
                            <h3><%=this.name%></h3>
                            <h4><a href="<%=this.album.uri%>"><%=this.album.name%></a></h4>
                        </div>
                        <div class="grid_6 omega contents">
                          <p><b><%=name%></b></p>
                          <button class="add-honk button icon" onclick="federate('<%=this.uri%>');"><span class="goose-blue"></span>honk honk</button>
                        </div>
                      </div>
                    </script>

                    <script type="text/html" id="playlistGooseSongRow_tmpl">
                    <![CDATA[
                        <li class="<%=this.highlightClass%>"><%=this.artists[0].name%> - <%=this.name%></li>
                    ]]>
                    </script>

                    <script type="text/html" id="playlistRow_tmpl">
                    <![CDATA[
                    <tr draggable="false" class="sp-list-item" data-uri="<%=this.item.uri%>"><td class="sp-list-cell sp-list-cell-star"><span class="sp-icon-star-hitarea"><span class="sp-icon-star sp-icon-starred"></span></span><span class="sp-icon-nowplaying"></span></td><td class="sp-list-cell sp-list-cell-track" style="width: 35%; "><%=this.item.name%></td><td class="sp-list-cell sp-list-cell-artist" style="width: 15%; "><a href="<%=this.item.artists[0].uri%>" data-uri="<%=this.item.artists[0].uri%>"><%=this.item.artists[0].name%></a></td><td class="sp-list-cell sp-list-cell-time"><%=this.item.formattedDuration%></td><td class="sp-list-cell sp-list-cell-album" style="width: 20%; "><a href="<%=this.item.album.uri%>" data-uri="<%=this.item.album.uri%>"><%=this.item.album.name%></a></td>
                        <td class="sp-list-cell" style="width:30%"><span class='sp-right'><button class='' onclick="stage('<%=this.item.uri%>')"><span class='goose-dark'></span>honk</button><button class='' onclick="stageMany('<%=this.item.uri%>')"><span class='goose-blue'></span>+honklist</button></span></td>
                    </tr>
                     ]]>
                    </script>

                <div id="playlistHeader" style="">
                    <div class="sp-list-header-table-wrapper">
                        <table class="sp-list-header-table">
                          <colgroup class="sp-list-colgroup"><col style="width: 30px; "><col style="width: 35%; "><col style="width: 15%; "><col style="width: 58px; "><col style="width: 20%; "><col style="width:30%"></colgroup>
                          <tbody>
                            <tr class="sp-list-header-row"><th class="sp-list-heading sp-list-cell-star">&nbsp;</th><th class="sp-list-heading sp-list-cell-track">Track<div class="sp-list-heading-handle"></div></th><th class="sp-list-heading sp-list-cell-artist">Artist<div class="sp-list-heading-handle"></div></th><th class="sp-list-heading sp-list-cell-time">Time<div class="sp-list-heading-handle"></div></th><th class="sp-list-heading sp-list-cell-album">Album<div class="sp-list-heading-handle"></div></th><th>Goose</th></tr>
                          </tbody>
                        </table>
                      </div>
                </div>
                <div id="playlistDiv"></div>
            </div>

            <div id="tailgoose" class="section" style="display:none;">
                <h1>Currently playing</h1>
                <div id="starredness"></div>

                <script type="text/html" id="taildetails_tmpl">
                  <div id="<%=uri%>">
                    <div>
                      <a class="artistLink"><img src="<%=image%>"/></a>
                    </div>
                    <div class="grid_6 omega contents">
                      <p><b><%=name%></b></p>
                    </div>
                  </div>
                </script>

                <div id="tailHolder">
                    <div id="taildetails"></div>
                    <div id="nowPlaying">Eery silence</div>
                </div>
            </div>

            <div id="offline" class="offline" class="section" style="display:none !important;">
                <h1>You have gone offline</h1>
                <p>If you're testing and want to override this, check this. 
                    <input type="checkbox" id="overrideSession" /> </p>
            </div>
        </div>

        <script>

            $(document).ready(function() {
                $("#searchTerm").keyup(function(event){
                    if(event.keyCode == 13){
                        search();
                        $("#searchTerm").blur();
                    }
                });

                var drop = document.querySelector('#lead-drop');
                drop.addEventListener('dragenter', handleDragEnter, false);
                drop.addEventListener('dragover', handleDragOver, false);
                drop.addEventListener('dragleave', handleDragLeave, false);
                drop.addEventListener('drop', handleDrop, false);

                //upgrade handled in require handleStartUp();//initialise connection to the server etc

            });

            
        </script>
    </body>
</html>